# Face Recognition System with FaceNet

This repository contains an implementation of a **Face Recognition System** using Deep Learning. The project demonstrates how to build a robust system capable of both **Face Verification** and **Face Recognition** using 128-dimensional encodings generated by a pre-trained Inception model (FaceNet).

##  Project Overview

Face recognition problems generally fall into two categories:

1.  **Face Verification (1:1):** "Is this the claimed person?" (e.g., unlocking a mobile phone).
2.  **Face Recognition (1:K):** "Who is this person?" (e.g., identifying an employee entering an office).

This project solves both problems by mapping face images into 128-dimensional encodings. If two images are of the same person, their encodings will be close to each other in vector space; if they are different people, they will be far apart.

##  Key Features

* **FaceNet Architecture:** Utilizes a pre-trained Inception network to compute facial encodings.
* **Triplet Loss:** Implements the Triplet Loss function, which minimizes the distance between an anchor and a positive (same identity) while maximizing the distance between the anchor and a negative (different identity).
* **One-Shot Learning:** Capable of recognizing a person given only one single example image of their face.
* **L2 Distance Metric:** Uses Euclidean distance to compare facial embeddings.

##  Implementation Details

### 1. Triplet Loss
The cost function used to train the network is defined as:

$$\mathcal{J} = \sum^{m}_{i=1} \large[ \small \mid \mid f(A^{(i)}) - f(P^{(i)}) \mid \mid_2^2 - \mid \mid f(A^{(i)}) - f(N^{(i)}) \mid \mid_2^2 + \alpha \large ] \small_+$$

Where:
* $A$ is an **Anchor** image.
* $P$ is a **Positive** image (same person as Anchor).
* $N$ is a **Negative** image (different person).
* $\alpha$ is the margin (set to 0.2).

### 2. Verification (`verify`)
Verifies if an input image matches a specific identity claimed by the user.
* **Logic:** Computes the distance between the input image encoding and the stored encoding for the claimed identity.
* **Threshold:** If the distance is $< 0.7$, the door opens.

### 3. Recognition (`who_is_it`)
Identifies a person from a database of allowed individuals.
* **Logic:** Computes the distance between the input image and *all* encodings in the database.
* **Result:** Returns the identity with the minimum distance, provided it is below the threshold.

##  Files

* `Face_Recognition.ipynb`: The main Jupyter Notebook containing the implementation.
* `images/`: Directory for input images.
* `keras-facenet-h5/`: Directory containing the pre-trained model weights.
* `fr_utils.py`: (Dependency) Utility functions for image processing.
* `inception_blocks_v2.py`: (Dependency) Implementation of the Inception architecture.

##  Prerequisites

To run this project, you need the following libraries:
* Python 3
* TensorFlow (Keras)
* NumPy
* Pandas
* Matplotlib
* Pillow (PIL)

##  Usage

1.  **Clone the repository:**
    ```bash
    git clone [https://github.com/your-username/face-recognition-system.git](https://github.com/your-username/face-recognition-system.git)
    ```

2.  **Load the Notebook:**
    Open `Face_Recognition.ipynb` in Jupyter.

3.  **Run the System:**
    * Load the pre-trained model.
    * Build the database of authorized personnel.
    * Use `verify()` to check specific identities.
    * Use `who_is_it()` to identify unknown faces from the camera.

    ```python
    # Example Usage
    who_is_it("images/camera_0.jpg", database, FRmodel)
    ```

##  References

This project is based on the Deep Learning Specialization by DeepLearning.AI and references the following papers:

* **FaceNet:** [FaceNet: A Unified Embedding for Face Recognition and Clustering](https://arxiv.org/pdf/1503.03832.pdf) by Schroff et al. (2015).
* **DeepFace:** [Closing the gap to human-level performance in face verification](https://research.fb.com/wp-content/uploads/2016/11/deepface-closing-the-gap-to-human-level-performance-in-face-verification.pdf) by Taigman et al. (2014).

##  License

This project is intended for educational purposes.
